{"version":3,"file":"measure.model.js","sourceRoot":"","sources":["measure.model.ts"],"names":[],"mappings":"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","sourcesContent":["import { Wove } from 'aspect.js/dist/lib/aspect';\nimport { LoggerAspect } from './../aspects/logger.aspect'\n\n\n@Wove(LoggerAspect)\nexport class Measure{\n\n\tid:number;\n\tmeasureUserTime:number;\n\tmeasureReferenceTime:number;\n\taccuracyUserTime:number;\n\taccuracyReferenceTime:number;\n\taccuracy:number;\n\taccuracyAge:number;\n\tpercentile:number;\n\tstatus: MeasureStatus = MeasureStatus.None;\n\tserviced:boolean = false;\n\trenewed:boolean = false;\n\n\tconstructor(id: number, measureUserTime: number, measureReferenceTime: number, \n\t\tstatus?: number, accuracyUserTime?: number, accuracyReferenceTime?: number, \n\t\taccuracy?: number, accuracyAge?: number, percentile?: number){\n\n\t\tthis.id = id\n\t\tthis.measureUserTime = measureUserTime;\n\t\tthis.measureReferenceTime = measureReferenceTime;\n\t\tthis.accuracyUserTime = accuracyUserTime;\n\t\tthis.accuracyReferenceTime = accuracyReferenceTime;\n\t\tthis.accuracy = accuracy;\n\t\tthis.accuracyAge = accuracyAge;\n\t\tthis.percentile = Math.round(percentile*10)/10;\n\n\t\tif(status >= 1){\n\t\t\tthis.status |= MeasureStatus.BaseMeasure;\n\t\t}\n\n\t\tif(status >= 2){\n\t\t\tthis.status |= MeasureStatus.AccuracyMeasure;\n\t\t}\n\n\t\tif (status >= 3) {\n\t\t\tthis.status |= MeasureStatus.ArchivedMeasure;\n\t\t}\n\n\t\tif(accuracyAge > 30){\n\t\t\tthis.renewed = true;\n\t\t\tthis.status |= MeasureStatus.ShouldBeRenewed;\n\t\t}\n\n\t\tif(Math.abs(accuracy) > 20){\n\t\t\tthis.serviced = true;\n\t\t\tthis.status |= MeasureStatus.ShouldBeServiced;\n\t\t}\n\n\t\tthis.computePostAccuracyStatus(accuracy, accuracyAge);\n\t}\n\n\tpublic toString = () : string => {\n\t\treturn `Measure (id: ${this.id},\n\t\tmeasureUserTime: ${this.measureUserTime},\n\t\tmeasureReferenceTime: ${this.measureReferenceTime},\n\t\taccuracyUserTime: ${this.accuracyUserTime},\n\t\taccuracyReferenceTime: ${this.accuracyReferenceTime},\n\t\taccuracy: ${this.accuracy},\n\t\taccuracyAge: ${this.accuracyAge},\n\t\tpercentile: ${this.percentile},\n\t\tstatus: ${this.status})`;\n\t}\n\n\taddBaseMeasure(referenceTime:number, userTime:number){\n\t\tthis.measureReferenceTime = referenceTime;\n\t\tthis.measureUserTime = userTime;\n\t\tthis.status |= MeasureStatus.BaseMeasure;\n\t}\n\n\taddAccuracyMeasure(referenceTime: number, userTime: number) {\n\t\tthis.accuracyReferenceTime = referenceTime;\n\t\tthis.accuracyUserTime = userTime;\n\t\tthis.status |= MeasureStatus.AccuracyMeasure;\n\t}\n\n\taddAccuracy(accuracy:number, accuracyAge:number, percentile:number){\n\t\tconsole.log(\"addAccuracy\", accuracy,accuracyAge,percentile);\n\t\tthis.accuracy = accuracy;\n\t\tthis.accuracyAge = accuracyAge;\n\t\tthis.percentile = Math.round(percentile*10)/10;\n\t\tthis.computePostAccuracyStatus(accuracy, accuracyAge);\n\t}\n\n\tprivate computePostAccuracyStatus(accuracy:number, accuracyAge:number){\n\t\tif (accuracy != null && accuracyAge != null) {\n\t\t\tif (Math.abs(accuracy) > 20) {\n\t\t\t\tthis.status |= MeasureStatus.ShouldBeServiced;\n\t\t\t\tthis.serviced = true;\n\t\t\t}\n\n\t\t\tif (accuracyAge > 30) {\n\t\t\t\tthis.renewed = true;\n\t\t\t\tthis.status |= MeasureStatus.ShouldBeRenewed;\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport enum MeasureStatus{\n\tNone = 0,\n\tBaseMeasure = 1 << 0,\n\tAccuracyMeasure = 1 << 1,\n\tArchivedMeasure = 1 << 2,\n\tShouldBeRenewed = 1 << 3,\n\tShouldBeServiced = 1 << 4\n}"]}