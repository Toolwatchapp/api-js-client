{"version":3,"file":"watch.model.js","sourceRoot":"","sources":["watch.model.ts"],"names":[],"mappings":"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","sourcesContent":["import { Measure, MeasureStatus } from './measure.model'\n\nexport class Watch{\n\tid:number;\n\tbrand:string;\n\thistorySize:number;\n\tmeasures:Measure[];\n\tname:string;\n\tyearOfBuy:number;\n\tserial:string;\n\tcaliber:string;\n\tstatus: WatchStatus = WatchStatus.None\n\tnext: WatchAction;\n\twaiting:number;\n\n\tconstructor(id: number, brand: string, historySize: number = 0,\n\t\tmeasures: Measure[] = [], name: string = \"\", yearOfBuy: number = null,\n\t\tserial: string = \"\", caliber: string = \"\") {\n\n\t\tthis.id = id;\n\t\tthis.brand = brand;\n\t\tthis.historySize = historySize;\n\t\tthis.measures = measures;\n\t\tthis.name = name;\n\t\tthis.yearOfBuy = yearOfBuy;\n\t\tthis.serial = serial;\n\t\tthis.caliber = caliber;\n\n\t\tif (historySize == 0){\n\t\t\tthis.status |= WatchStatus.NeverMeasured;\n\t\t\tthis.next = WatchAction.Measure;\n\t\t}else if(historySize > this.measures.length){\n\t\t\tthis.status |= WatchStatus.HaveMoreMeasures;\n\t\t}\n\n\t\tlet lastMeasure = this.currentMeasure();\n\t\tif (lastMeasure !== null \n\t\t\t&& lastMeasure.status & MeasureStatus.BaseMeasure){\n\n\t\t\tconsole.log(lastMeasure.measureUserTime, Date.now());\n\t\t\tconsole.log(lastMeasure.measureUserTime - Date.now()/1000);\n\t\t\tconsole.log((lastMeasure.measureUserTime - Date.now()/1000)/3600);\n\t\t\tconsole.log(Math.abs((lastMeasure.measureUserTime - Date.now()/1000)/3600));\n\n\t\t\tif (Math.abs((lastMeasure.measureUserTime - Date.now()/1000)/3600) < 12){\n\t\t\t\tthis.next = WatchAction.Waiting;\n\t\t\t\tthis.waiting = Math.round(12 - Math.abs((lastMeasure.measureUserTime - Date.now()/1000)/3600));\n\t\t\t}else if(!(lastMeasure.status & MeasureStatus.AccuracyMeasure)) {\n\t\t\t\tthis.next = WatchAction.Accuracy;\n\t\t\t}else{\n\t\t\t\tthis.next = WatchAction.Measure;\n\t\t\t}\n\t\t}\n\t}\n\n\n\tcurrentMeasure():Measure{\n\t\tif(this.measures.length !== 0){\n\t\t\treturn this.measures[this.measures.length - 1];\n\t\t}else{\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tupsertMeasure(measure:Measure){\n\n\t\tconsole.log(\"this\", this);\n\t\tconsole.log(\"measure\", measure);\n\t\tfor (var i = 0; i < this.measures.length; i++) {\n\t\t\tconsole.log(\"i\", i);\n\t\t\tif(this.measures[i].id == measure.id){\n\t\t\t\tthis.measures[i] = measure;\n\t\t\t\tconsole.log(\"return\", this, this.measures[i], measure);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tthis.measures.push(measure);\n\t\tconsole.log(\"this2\", this);\n\t}\n}\n\nexport enum WatchAction{\n\tMeasure, Waiting, Accuracy\n}\n\nexport enum WatchStatus{\n\tNone = 0,\n\tNeverMeasured = 1 << 1,\n\tHaveMoreMeasures = 1 << 2\n}"]}